<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="texto_titulo">Ingresar nueva Compra - No domiciliado 8.2</h4>
        </div>                         
        <div class="modal-body">
            <form>
                <div class="row">
                    <div class="col-md-4">
                        <label for="periodo">Periodo:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="periodo"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="codigo_unico">Código unico:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="codigo_unico"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_correlativo">Número correlativo:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_correlativo"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="fecha_emision">Fecha de Emisión:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="fecha_emision"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_documento">Tipo documento:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_documento"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="serie">Serie:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="serie"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero">Número:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero"/>
                    </div>                    
                </div><hr><br>                                                                
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="adquisicion">Adquisición:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="adquisicion"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="otros_conceptos">Otros conceptos:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="otros_conceptos"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="importe_total">Importe total:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="importe_total"/>
                    </div>                    
                </div><hr><br>                                                               

                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_comprobante_pago">Tipo comprobante pago:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_comprobante_pago"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="serie_pago">Serie del pago:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="serie_pago"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="anio_dua">año DUA:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="anio_dua"/>
                    </div>
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_pago">Número pago:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_pago"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="retencion_igv">Retencion IGV:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="retencion_igv"/>
                    </div>                    
                </div><hr><br>                                                                                

                <div class="row">
                    <div class="col-md-4">
                        <label for="codigo_moneda">Código moneda:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="codigo_moneda"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_cambio">Tipo de cambio:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_cambio"/>
                    </div>                    
                </div><hr><br>               
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="pais_sujeto">País sujeto no domiciliado:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="pais_sujeto"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="razon_sujeto">Razón del sujeto no domiciliado:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="razon_sujeto"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="domicilio_sujeto">Domicilio del sujeto no domiciliado:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="domicilio_sujeto"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_documento_sujeto">Número de documento del sujeto:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_documento_sujeto"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_documento_beneficiario">Número de documento del beneficiario:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_documento_beneficiario"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="razon_beneficiario">Razón del beneficiario:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="razon_beneficiario"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="pais_beneficiario">País del beneficiario:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="pais_beneficiario"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="vinculo">Vinculo:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="vinculo"/>
                    </div>
                </div><br>                                                
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="renta_bruta">Renta bruta:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="renta_bruta"/>
                    </div>                    
                </div><hr><br>
                                        
                <div class="row">
                    <div class="col-md-4">
                        <label for="deduccion">Deducción:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="deduccion"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="renta_neta">Renta neta:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="renta_neta"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="taza_retencion">Taza de retencion:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="taza_retencion"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="impuesto_retenido">Impuesto retenido:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="impuesto_retenido"/>
                    </div>
                </div><hr><br>
                
                                
                <div class="row">
                    <div class="col-md-4">
                        <label for="doble_disposicion">Doble disposición:</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="doble_disposicion"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="exoneracion_aplicada">Exoneración aplicada</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="exoneracion_aplicada"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_renta">Tipo de renta</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_renta"/>
                    </div>                    
                </div><br>                                
                <div class="row">
                    <div class="col-md-4">
                        <label for="modalidad">Modalidad</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="modalidad"/>
                    </div>                    
                </div><br>                
                <div class="row">
                    <div class="col-md-4">
                        <label for="aplica_ley">Aplica ley</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="aplica_ley"/>
                    </div>                    
                </div><br>                
                <div class="row">
                    <div class="col-md-4">
                        <label for="estado">Estado:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="estado"/>
                    </div>                    
                </div><br>                                
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-primary" id="btn_guardar_operacion">Guardar</button>
            <input type="hidden" class="form form-control" id="id"/>
        </div>
    </div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
<script type="text/javascript">    
    var anio_actual = <?php echo date("Y");?>;
    var base_url = '<?PHP echo base_url();?>';
    
    var i ;
    var j = 0;
    for(i = (anio_actual - 30); i < anio_actual; i++){
        $('#anio').append("<option value='" + (anio_actual - j) + "'>" + (anio_actual - j) + "</option>");
        j++;
    }
    
    var url_l = base_url + 'index.php/WS_variables_diversas/meses';
    $.getJSON(url_l)
    .done(function (data){
        var m;
        for(m = 0; m < 12 ; m++ ){
            $('#mes').append("<option value='" + (m + 1) + "'>" + data[m+1] + "</option>");
        }
    });
    
    $(document).ready(function(){
        var today = new Date();                
        var dd = today.getDate(); 
        var mm = today.getMonth() + 1;   
        var yyyy = today.getFullYear();
        
        if (dd < 10) { 
            dd = '0' + dd; 
        } 
        if (mm < 10) { 
            mm = '0' + mm; 
        } 
        var today = dd + '-' + mm + '-' + yyyy; 

        $('#fecha_emision').val(today);
        $('#fecha_emision').datepicker();        
        $("#fecha_vencimiento").datepicker();
        $("#da_fecha_emision").datepicker();
        $("#fecha_emision_detraccion").datepicker();
                
        $("#btn_guardar_operacion").on('click', function(){
            var data = {
                periodo:$('#periodo').val(),
                codigo_unico:$('#codigo_unico').val(),
                numero_correlativo:$('#numero_correlativo').val(),                                               
                                
                fecha_emision:$('#fecha_emision').val(),
                tipo_documento:$('#tipo_documento').val(),                                
                
                serie:$('#serie').val(),
                numero:$('#numero').val(),
                adquisicion:$('#adquisicion').val(),
                otros_conceptos:$('#otros_conceptos').val(),
                importe_total:$('#importe_total').val(),                                
                
                tipo_comprobante_pago:$('#tipo_comprobante_pago').val(),
                serie_pago:$('#serie_pago').val(),
                anio_dua:$('#anio_dua').val(),
                numero_pago:$('#numero_pago').val(),
                retencion_igv:$('#retencion_igv').val(),                                
                
                codigo_moneda:$('#codigo_moneda').val(),
                tipo_cambio:$('#tipo_cambio').val(),                                
                
                pais_sujeto:$('#pais_sujeto').val(),
                razon_sujeto:$('#razon_sujeto').val(),
                domicilio_sujeto:$('#domicilio_sujeto').val(),
                numero_documento_sujeto:$('#numero_documento_sujeto').val(),
                
                numero_documento_beneficiario:$('#numero_documento_beneficiario').val(),                
                razon_beneficiario:$('#razon_beneficiario').val(),
                pais_beneficiario:$('#pais_beneficiario').val(),                
                vinculo:$('#vinculo').val(),                
                
                renta_bruta:$('#renta_bruta').val(),
                deduccion:$('#deduccion').val(),
                renta_neta:$('#renta_neta').val(),
                taza_retencion:$('#taza_retencion').val(),                
                impuesto_retenido:$('#impuesto_retenido').val(),                
                
                doble_disposicion:$('#doble_disposicion').val(),
                exoneracion_aplicada:$('#exoneracion_aplicada').val(),                
                tipo_renta:$('#tipo_renta').val(),                
                modalidad:$('#modalidad').val(),
                aplica_ley:$('#aplica_ley').val(),                
                estado:$('#estado').val(),
                                
                id:$('#id').val()
            };
            
            var url_save = base_url + 'index.php/le_compras8_2_detalles/operaciones';
            $.getJSON(url_save, data)
            .done(function(datos, textStatus, jqXHR){
                toast('success', 1500, 'Operación ingresado correctamente');
                $("#myModal").modal('hide');
                $("#tabla_id > tbody").remove();
                carga_inicial();
            })
            .fail(function( jqXHR, textStatus, errorThrown ) {
                if ( console && console.log ) {
                    console.log( "Algo ha fallado: " +  textStatus );
                }
            });
        });
    });
</script>
