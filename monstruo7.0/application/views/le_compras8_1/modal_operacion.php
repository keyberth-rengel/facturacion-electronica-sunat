<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="texto_titulo">Ingresar nueva Compra</h4>
        </div>                         
        <div class="modal-body">
            <form>                
                      
                <div class="row">
                    <div class="col-md-4">
                        <label for="periodo">Periodo:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="periodo"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="codigo_unico">Código unico:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="codigo_unico"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_correlativo">Número correlativo:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_correlativo"/>
                    </div>                    
                </div><hr><br>                                             
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="fecha_emision">Fecha de Emisión:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="fecha_emision"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="fecha_vencimiento">Fecha de vencimiento:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="fecha_vencimiento"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_documento">Tipo documento:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_documento"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="serie">serie:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="serie"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="anio_dua">Año DUA:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="anio_dua"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero">Número:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_final">Número final:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_final"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_documento_proveedor">Tipo documento Proveedor:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_documento_proveedor"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_documento">Número documento:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_documento"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="razon_social">Razón social/Nombres completos:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="razon_social"/>
                    </div>
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="base_imponible_tipo_1">Base Imponible(Venta con IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="base_imponible_tipo_1"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="igv_tipo_1">IGV(Venta con IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="igv_tipo_1"/>
                    </div>                    
                </div><br>                
                <div class="row">
                    <div class="col-md-4">
                        <label for="base_imponible_tipo_2">Base Imponible(Venta con/sin IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="base_imponible_tipo_2"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="igv_tipo_2">IGV(Venta con/sin IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="igv_tipo_2"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="base_imponible_tipo_3">Base Imponible(Venta sin IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="base_imponible_tipo_3"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="igv_tipo_3">IGV(Venta sin IGV):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="igv_tipo_3"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="no_grabadas">No grabadas:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="no_grabadas"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="isc">ISC:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="isc"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="ICBPER">ICBPER(Impuesto a la bolsa):</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="ICBPER"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="otros_conceptos">Otros conceptos:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="otros_conceptos"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="importe_total">Importe total:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="importe_total"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="codigo_moneda">Código moneda:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="codigo_moneda"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="tipo_cambio">Tipo cambio:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="tipo_cambio"/>
                    </div>                    
                </div><hr><br>
                                        
                <div class="row">
                    <div class="col-md-4">
                        <label for="da_fecha_emision">Fecha_emision(Doc. Rel.):</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="da_fecha_emision"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="da_tipo_documento">Tipo_documento(Doc. Rel.):</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="da_tipo_documento"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="da_serie">Serie(Doc. Rel.):</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="da_serie"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="da_dua">Año DUA(Doc. Rel.):</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="da_dua"/>
                    </div>
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="da_numero">Número(Doc. Rel.):</label>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="da_numero"/>
                    </div>
                </div><hr><br>                                
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="fecha_emision_detraccion">fecha emisión(Detracción)</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="fecha_emision_detraccion"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="numero_deposito_detraccion">Número depósito(Detracción)</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="numero_deposito_detraccion"/>
                    </div>                    
                </div><hr><br>
                                
                <div class="row">
                    <div class="col-md-4">
                        <label for="sujeto_retencion">Sujeto retención</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="sujeto_retencion"/>
                    </div>                    
                </div><hr><br>
                
                <div class="row">
                    <div class="col-md-4">
                        <label for="clasificacion_bienes">Clasificación de bienes</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="clasificacion_bienes"/>
                    </div>                    
                </div><br>                
                <div class="row">
                    <div class="col-md-4">
                        <label for="identificacion_contrato">Identificacion de contrato:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="identificacion_contrato"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="error_tipo_1">Error tipo 1:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="error_tipo_1"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="error_tipo_2">Error tipo 2:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="error_tipo_2"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="error_tipo_3">Error tipo 3:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="error_tipo_3"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="error_tipo_4">Error tipo 4:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="error_tipo_4"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="medio_pago_cancelacion">Medio pago cancelación:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="medio_pago_cancelacion"/>
                    </div>                    
                </div><br>
                <div class="row">
                    <div class="col-md-4">
                        <label for="estado">estado:</label>
                    </div>                    
                    <div class="col-md-6">
                        <input type="text" class="form form-control" id="estado"/>
                    </div>                    
                </div><br>                
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-primary" id="btn_guardar_operacion">Guardar</button>
            <input type="hidden" class="form form-control" id="id"/>
        </div>
    </div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
<script type="text/javascript">    
    var anio_actual = <?php echo date("Y");?>;
    var base_url = '<?PHP echo base_url();?>';
    
    var i ;
    var j = 0;
    for(i = (anio_actual - 30); i < anio_actual; i++){
        $('#anio').append("<option value='" + (anio_actual - j) + "'>" + (anio_actual - j) + "</option>");
        j++;
    }
    
    var url_l = base_url + 'index.php/WS_variables_diversas/meses';
    $.getJSON(url_l)
    .done(function (data){
        var m;
        for(m = 0; m < 12 ; m++ ){
            $('#mes').append("<option value='" + (m + 1) + "'>" + data[m+1] + "</option>");
        }
    });
    
    $(document).ready(function(){
        var today = new Date();                
        var dd = today.getDate(); 
        var mm = today.getMonth() + 1;   
        var yyyy = today.getFullYear();
        
        if (dd < 10) { 
            dd = '0' + dd; 
        } 
        if (mm < 10) { 
            mm = '0' + mm; 
        } 
        var today = dd + '-' + mm + '-' + yyyy; 

        $('#fecha_emision').val(today);
        $('#fecha_emision').datepicker();        
        $("#fecha_vencimiento").datepicker();
        $("#da_fecha_emision").datepicker();
        $("#fecha_emision_detraccion").datepicker();
                
        $("#btn_guardar_operacion").on('click', function(){
            var data = {
                periodo:$('#periodo').val(),
                codigo_unico:$('#codigo_unico').val(),
                numero_correlativo:$('#numero_correlativo').val(),
                
                fecha_emision:$('#fecha_emision').val(),
                fecha_vencimiento:$('#fecha_vencimiento').val(),
                tipo_documento:$('#tipo_documento').val(),
                serie:$('#serie').val(),
                anio_dua:$('#anio_dua').val(),
                numero:$('#numero').val(),
                numero_final:$('#numero_final').val(),
                
                tipo_documento_proveedor:$('#tipo_documento_proveedor').val(),
                numero_documento:$('#numero_documento').val(),
                razon_social:$('#razon_social').val(),
                
                base_imponible_tipo_1:$('#base_imponible_tipo_1').val(),
                igv_tipo_1:$('#igv_tipo_1').val(),
                base_imponible_tipo_2:$('#base_imponible_tipo_2').val(),
                igv_tipo_2:$('#igv_tipo_2').val(),
                base_imponible_tipo_3:$('#base_imponible_tipo_3').val(),
                igv_tipo_3:$('#igv_tipo_3').val(),
                no_grabadas:$('#no_grabadas').val(),
                isc:$('#isc').val(),
                ICBPER:$('#ICBPER').val(),
                otros_conceptos:$('#otros_conceptos').val(),
                importe_total:$('#importe_total').val(),
                
                codigo_moneda:$('#codigo_moneda').val(),
                tipo_cambio:$('#tipo_cambio').val(),
                
                da_fecha_emision:$('#da_fecha_emision').val(),
                da_tipo_documento:$('#da_tipo_documento').val(),
                da_serie:$('#da_serie').val(),
                da_dua:$('#da_dua').val(),                
                da_numero:$('#da_numero').val(),
                
                fecha_emision_detraccion:$('#fecha_emision_detraccion').val(),
                numero_deposito_detraccion:$('#numero_deposito_detraccion').val(),
                
                sujeto_retencion:$('#sujeto_retencion').val(),
                
                clasificacion_bienes:$('#clasificacion_bienes').val(),
                identificacion_contrato:$('#identificacion_contrato').val(),
                error_tipo_1:$('#error_tipo_1').val(),
                error_tipo_2:$('#error_tipo_2').val(),
                error_tipo_3:$('#error_tipo_3').val(),
                error_tipo_4:$('#error_tipo_4').val(),
                medio_pago_cancelacion:$('#medio_pago_cancelacion').val(),
                estado:$('#estado').val(),
                                
                id:$('#id').val()
            };
            
            var url_save = base_url + 'index.php/le_compras8_1_detalles/operaciones';
            $.getJSON(url_save, data)
            .done(function(datos, textStatus, jqXHR){
                toast('success', 1500, 'Operación ingresado correctamente');
                $("#myModal").modal('hide');
                $("#tabla_id > tbody").remove();
                carga_inicial();
            })
            .fail(function( jqXHR, textStatus, errorThrown ) {
                if ( console && console.log ) {
                    console.log( "Algo ha fallado: " +  textStatus );
                }
            });
        });
    });
</script>
